"use strict";(self.webpackChunkjiffy=self.webpackChunkjiffy||[]).push([[5309],{95309:function(e,t,n){n.r(t);var i=n(35466),r=n(24123),a=n(15300),l=n(49624),o=n(55702),c=n(40137),s=n(1554),u=n(96990),d=n(24801),m=n(39084),_=n(2895),f=n(79520),p=n(59854),g=n(55128),E=n(13974),y=n.n(E);function b(e,t,n,i,r,a,l){try{var o=e[a](l),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(i,r)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a=[],l=!0,o=!1;try{for(n=n.call(e);!(l=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);l=!0);}catch(e){o=!0,r=e}finally{try{l||null==n.return||n.return()}finally{if(o)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var $=r.Z.Option,h=a.Z.TextArea;t.default=o.Z.create()((function(e){var t=e.form,n=v((0,i.useState)([]),2),E=n[0],Z=n[1],I=v((0,p.Db)(g.y$),2);I[0],I[1].loading,(0,i.useEffect)((function(){for(var t=[],n=1;n<=e.count;n++)t.push({count:n,file:[],image:[],title:"",description:"",error_title:!1});Z(t)}),[e]);var k=function(e){var t=E.splice(e,1);Z(t)},D=function(e){return Array.isArray(e)?e:e&&e.fileList};return i.createElement(i.Fragment,null,i.createElement(l.Z,null,i.createElement(o.Z,{name:"nested-milestone",className:""},(E||[]).map((function(e,n){return console.log("CreateMilestone -> field",e),i.createElement(i.Fragment,null,i.createElement(l.Z,{gutter:[16,0]},i.createElement(c.Z,{span:24},i.createElement("div",{className:"d-flex w-100 justify-content-between normal_font_size pb-3"},i.createElement("div",null," Milestone ",n+1),E.length>=2&&i.createElement(s.Z,{title:"Sure to delete milestone ?",onConfirm:function(){return k(n)}},i.createElement("div",{className:"cursor_point d-flex justify-content-between align-items-center text-danger"},i.createElement(u.Z,{className:"px-3",type:"delete"})," ",i.createElement("div",null,"Remove")))))),i.createElement(l.Z,{gutter:[16,0]},i.createElement(c.Z,{span:24},i.createElement(o.Z.Item,{label:"Title",key:n},t.getFieldDecorator("title_".concat(n),{keys:"",initialValue:"",rules:[{required:!!e.error_title}]})(i.createElement(a.Z,{size:"large",className:"w-100"}))))),i.createElement(l.Z,{gutter:[16,0]},i.createElement(c.Z,{span:24},i.createElement(o.Z.Item,{label:"Description",key:n},t.getFieldDecorator("description_".concat(n),{keys:"",initialValue:""})(i.createElement(h,{size:"large",rows:6}))))),i.createElement(l.Z,{gutter:[16,0]},i.createElement(c.Z,{span:12},i.createElement(o.Z.Item,{label:"Amount to be released",key:n},t.getFieldDecorator("budget_".concat(n),{keys:"",initialValue:""})(i.createElement(a.Z,{type:"number",size:"large",className:"w-100",min:1,addonAfter:"KSH"})))),i.createElement(c.Z,{span:6},i.createElement(o.Z.Item,{label:"Duration",key:n},t.getFieldDecorator("timeline_".concat(n),{keys:"",initialValue:""})(i.createElement(d.Z,{type:"number",size:"large",className:"w-100",min:1})))),i.createElement(c.Z,{span:6},i.createElement(o.Z.Item,{label:"time type",key:n},t.getFieldDecorator("timeline_type_".concat(n),{keys:"",initialValue:""})(i.createElement(r.Z,{defaultValue:"days",size:"large",className:"w-100"},i.createElement($,{value:"days"},"Days"),i.createElement($,{value:"months"},"Months"),i.createElement($,{value:"years"},"Years")))))),i.createElement(l.Z,{gutter:[16,0]},i.createElement(c.Z,{span:24},i.createElement("div",null,i.createElement(o.Z.Item,{label:""},t.getFieldDecorator("file_".concat(n),{rules:[],valuePropName:"fileList",getValueFromEvent:D})(i.createElement(m.Z,{name:"logo",multiple:!0,listType:"picture-card",action:"/upload.do"},i.createElement("div",null,i.createElement(u.Z,{type:"plus"}),i.createElement("div",{className:"ant-upload-text"},"Upload")))))))),i.createElement(l.Z,{gutter:[16,0]},i.createElement(c.Z,{span:12},E.length>=2&&i.createElement(s.Z,{title:"Sure to delete milestone ?",onConfirm:function(){return k(n)}},i.createElement(_.Z,{size:"large",block:!0,className:"normal_font_size"},i.createElement("div",{className:"px-2"}," Cancel")))),i.createElement(c.Z,{span:12},i.createElement(_.Z,{size:"large",block:!0,onClick:function(){!function(e,n){console.log("save_milestone -> form"),t.validateFields(function(){var e,t=(e=regeneratorRuntime.mark((function e(t,i){var r,a,l,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=23;break}if(r=[],a={},y().size(i["file_".concat(n)])&&(r=i["file_".concat(n)].map((function(e){return e.originFileObj}))),a.title=i["title_".concat(n)],a.description=i["description_".concat(n)],a.timeline=i["timeline_".concat(n)],a.timeline_type=i["timeline_type_".concat(n)],a.budget=i["budget_".concat(n)],!(a.budget&&a.title&&a.timeline_type&&a.description&&a.timeline)){e.next=20;break}return l={milestone_data:a},y().size(r)&&(l.file=r),console.log("save_milestone -> input_data",l),e.abrupt("return",!1);case 16:"success"===(o=e.sent).data.update_milestone.status&&(0,f.F)(o.data.update_milestone),e.next=21;break;case 20:(0,f.F)({msg:"Please fill all the field",status:"failed"});case 21:e.next=24;break;case 23:(0,f.F)({msg:"Milestone update failed",status:"failed"});case 24:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function l(e){b(a,i,r,l,o,"next",e)}function o(e){b(a,i,r,l,o,"throw",e)}l(void 0)}))});return function(e,n){return t.apply(this,arguments)}}())}(0,n)},className:"bg-gradient-primary text-white normal_font_size"},i.createElement("div",{className:"px-2"}," Done")))))})))))}))},55128:function(e,t,n){n.d(t,{aY:function(){return c},y$:function(){return s}});var i,r,a,l=n(82992);function o(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var c=(0,l.ZP)(i||(i=o(["\n    query GETMILESTONEPAGINATION($_id:ID,$contract_id:ID,$biding_id:ID,$location_code:String){\n        get_biding_milestone(_id:$_id,contract_id:$contract_id,biding_id:$biding_id){\n                _id\n                budget(code:$location_code)\n                ref: milestone_ref\n                created_at\n                user_id\n                contract_id\n                timeline\n                timeline_type\n                payment_option(code:$location_code)\n                booking_status\n                description\n                title\n                pro_description\n                extra_fare\n                extra_fare_reason\n                total(code:$location_code)\n                get_milestone_all_images(root:true){\n                    small_image\n                }\n        }\n    }\n"]))),s=((0,l.ZP)(r||(r=o(["\n    query GETMILESTONEDETAIL($_id:ID,$contract_id:ID,$biding_id:ID){\n        get_biding_milestone_detail(_id:$_id,contract_id:$contract_id,biding_id:$biding_id){\n            _id\n            budget\n            ref: milestone_ref\n            created_at\n            user_id\n            contract_id\n            description\n            timeline\n            timeline_type\n        }\n    }\n"]))),(0,l.ZP)(a||(a=o(["\nmutation UPDATEMILESTONE($option:String  \n    $_id:ID\n    $user_id: String\n    $provider_id:ID\n    $biding_id:ID\n    $contract_id:ID\n    $file:[Upload]\n    $milestone_data:JSON){ \n    update_milestone(\n        option:$option  \n        _id:$_id\n        user_id: $user_id\n        provider_id:$provider_id\n        biding_id:$biding_id\n        contract_id:$contract_id\n        file:$file\n        milestone_data:$milestone_data\n  ) {\n    msg\n    status\n  }\n}"]))))}}]);