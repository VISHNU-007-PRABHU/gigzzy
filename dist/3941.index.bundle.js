"use strict";(self.webpackChunkjiffy=self.webpackChunkjiffy||[]).push([[3941],{23941:function(e,t,r){r.r(t),r.d(t,{default:function(){return K}});var n=r(35466),i=r(69753),o=r(57622),a=r(85832),s=r(97533),c=r(89860),u=r(43320),l=function(){function e(e,t){this.isMounted=!1,this.previousOptions={},this.context={},this.options={},this.options=e||{},this.context=t||{}}return e.prototype.getOptions=function(){return this.options},e.prototype.setOptions=function(e){(0,c.D)(this.options,e)||(this.previousOptions=this.options),this.options=e},e.prototype.unmount=function(){this.isMounted=!1},e.prototype.refreshClient=function(){var e=this.options&&this.options.client||this.context&&this.context.client;(0,u.kG)(!!e,'Could not find "client" in the context or passed in as an option. Wrap the root component in an <ApolloProvider>, or pass an ApolloClient instance in via options.');var t=!1;return e!==this.client&&(t=!0,this.client=e,this.cleanup()),{client:this.client,isNew:t}},e.prototype.verifyDocumentType=function(e,t){var r=(0,a.E2)(e),n=(0,a.mw)(t),i=(0,a.mw)(r.type);(0,u.kG)(r.type===t,"Running a "+n+" requires a graphql "+n+", but a "+i+" was used instead.")},e}(),p=function(e){function t(t){var r=t.options,n=t.context,i=t.forceUpdate,o=e.call(this,r,n)||this;return o.previousData={},o.currentObservable={},o.runLazy=!1,o.runLazyQuery=function(e){o.runLazy=!0,o.lazyOptions=e,o.forceUpdate()},o.getExecuteResult=function(){var e=o.getQueryResult();return o.startQuerySubscription(),e},o.forceUpdate=i,o}return o.ZT(t,e),t.prototype.execute=function(){this.refreshClient();var e=this.getOptions(),t=e.skip,r=e.query;return(t||r!==this.previousData.query)&&(this.removeQuerySubscription(),this.previousData.query=r),this.updateObservableQuery(),this.isMounted&&this.startQuerySubscription(),this.getExecuteSsrResult()||this.getExecuteResult()},t.prototype.executeLazy=function(){return this.runLazy?[this.runLazyQuery,this.execute()]:[this.runLazyQuery,{loading:!1,networkStatus:s.Ie.ready,called:!1,data:void 0}]},t.prototype.fetchData=function(){if(this.getOptions().skip)return!1;var e=this.getOptions(),t=(e.children,e.ssr),r=(e.displayName,e.skip,e.onCompleted,e.onError,e.partialRefetch,o._T(e,["children","ssr","displayName","skip","onCompleted","onError","partialRefetch"])),n=r.fetchPolicy;if(!1===t)return!1;"network-only"!==n&&"cache-and-network"!==n||(n="cache-first");var i=this.refreshClient().client.watchQuery(o.pi({},r,{fetchPolicy:n}));return this.context&&this.context.renderPromises&&this.context.renderPromises.registerSSRObservable(i,this.getOptions()),!!this.currentObservable.query.getCurrentResult().loading&&i.result()},t.prototype.afterExecute=function(e){var t=(void 0===e?{}:e).lazy,r=void 0!==t&&t;return this.isMounted=!0,r&&!this.runLazy||this.handleErrorOrCompleted(),this.unmount.bind(this)},t.prototype.cleanup=function(){this.removeQuerySubscription(),delete this.currentObservable.query,delete this.previousData.result},t.prototype.getOptions=function(){var t=e.prototype.getOptions.call(this),r=this.lazyOptions||{},n=o.pi({},t,{variables:o.pi({},t.variables,r.variables),context:o.pi({},t.context,r.context)});return this.runLazy&&delete n.skip,n},t.prototype.getExecuteSsrResult=function(){var e,t={loading:!0,networkStatus:s.Ie.loading,called:!0,data:{}};return this.context&&this.context.renderPromises&&((e=this.context.renderPromises.addQueryPromise(this,this.getExecuteResult))||(e=t)),e},t.prototype.updateCurrentData=function(){this.isMounted&&this.forceUpdate()},t.prototype.prepareObservableQueryOptions=function(){this.verifyDocumentType(this.getOptions().query,a.n_.Query);var e=this.getOptions().displayName||"Query";return o.pi({},this.getOptions(),{displayName:e,context:this.getOptions().context||{},metadata:{reactComponent:{displayName:e}}})},t.prototype.observableQueryFields=function(e){return{variables:e.variables,refetch:e.refetch.bind(e),fetchMore:e.fetchMore.bind(e),updateQuery:e.updateQuery.bind(e),startPolling:e.startPolling.bind(e),stopPolling:e.stopPolling.bind(e),subscribeToMore:e.subscribeToMore.bind(e)}},t.prototype.initializeObservableQuery=function(){if(this.context&&this.context.renderPromises&&(this.currentObservable.query=this.context.renderPromises.getSSRObservable(this.getOptions())),!this.currentObservable.query){var e=this.prepareObservableQueryOptions();this.previousData.observableQueryOptions=o.pi({},e,{children:null}),this.currentObservable.query=this.refreshClient().client.watchQuery(e)}},t.prototype.updateObservableQuery=function(){this.currentObservable.query||this.initializeObservableQuery();var e=o.pi({},this.prepareObservableQueryOptions(),{children:null});(0,c.D)(e,this.previousData.observableQueryOptions)||(this.previousData.observableQueryOptions=e,this.currentObservable.query.setOptions(e).catch((function(){})))},t.prototype.startQuerySubscription=function(){var e=this;if(!this.currentObservable.subscription&&!this.getOptions().skip){var t=this.currentObservable.query;this.currentObservable.subscription=t.subscribe({next:function(t){var r=t.loading,n=t.networkStatus,i=t.data;e.previousData.result&&e.previousData.result.loading===r&&e.previousData.result.networkStatus===n&&(0,c.D)(e.previousData.result.data,i||{})||e.updateCurrentData()},error:function(t){if(e.resubscribeToQuery(),!t.hasOwnProperty("graphQLErrors"))throw t;e.updateCurrentData()}})}},t.prototype.resubscribeToQuery=function(){this.removeQuerySubscription();var e=this.currentObservable.query.getLastError(),t=this.currentObservable.query.getLastResult();this.currentObservable.query.resetLastResults(),this.startQuerySubscription(),Object.assign(this.currentObservable.query,{lastError:e,lastResult:t})},t.prototype.getQueryResult=function(){var e=this,t={data:Object.create(null)};if(Object.assign(t,this.observableQueryFields(this.currentObservable.query)),this.getOptions().skip)t=o.pi({},t,{data:void 0,error:void 0,loading:!1,called:!0});else{var r=this.currentObservable.query.getCurrentResult(),n=r.loading,i=r.partial,a=r.networkStatus,c=r.errors,u=r.error,l=r.data;if(l=l||Object.create(null),c&&c.length>0&&(u=new s.cA({graphQLErrors:c})),Object.assign(t,{loading:n,networkStatus:a,error:u,called:!0}),n){var p=this.previousData.result?this.previousData.result.data:{};Object.assign(t.data,p,l)}else if(u)Object.assign(t,{data:(this.currentObservable.query.getLastResult()||{}).data});else{var d=this.currentObservable.query.options.fetchPolicy;if(this.getOptions().partialRefetch&&0===Object.keys(l).length&&i&&"cache-only"!==d)return Object.assign(t,{loading:!0,networkStatus:s.Ie.loading}),t.refetch(),t;Object.assign(t.data,l)}}return setTimeout((function(){e.currentObservable.query.resetQueryStoreErrors()})),t.client=this.client,this.previousData.loading=this.previousData.result&&this.previousData.result.loading||!1,this.previousData.result=t,t},t.prototype.handleErrorOrCompleted=function(){var e=this.currentObservable.query.getCurrentResult(),t=e.data,r=e.loading,n=e.error;if(!r){var i=this.getOptions(),o=i.query,a=i.variables,s=i.onCompleted,u=i.onError;if(this.previousOptions&&!this.previousData.loading&&(0,c.D)(this.previousOptions.query,o)&&(0,c.D)(this.previousOptions.variables,a))return;s&&!n?s(t):u&&n&&u(n)}},t.prototype.removeQuerySubscription=function(){this.currentObservable.subscription&&(this.currentObservable.subscription.unsubscribe(),delete this.currentObservable.subscription)},t}(l);var d=r(55128),f=r(69113),y=r.n(f),b=r(92703),h=r.n(b),v=r(45708),m=r(10739);function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g.apply(this,arguments)}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _=function(e){return n.createElement(m.C,null,(function(t){var r,i,o=t.getPrefixCls,a=e.prefixCls,s=e.className,c=e.color,u=void 0===c?"":c,l=e.children,p=e.pending,d=e.dot,f=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["prefixCls","className","color","children","pending","dot"]),y=o("timeline",a),b=h()((O(r={},"".concat(y,"-item"),!0),O(r,"".concat(y,"-item-pending"),p),r),s),m=h()((O(i={},"".concat(y,"-item-head"),!0),O(i,"".concat(y,"-item-head-custom"),d),O(i,"".concat(y,"-item-head-").concat(u),!0),i));return n.createElement("li",g({},(0,v.default)(f,["position"]),{className:b}),n.createElement("div",{className:"".concat(y,"-item-tail")}),n.createElement("div",{className:m,style:{borderColor:/blue|red|green|gray/.test(u)?void 0:u}},d),n.createElement("div",{className:"".concat(y,"-item-content")},l))}))};_.defaultProps={color:"blue",pending:!1,position:""};var E=_,x=r(96990);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function w(){return w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w.apply(this,arguments)}function D(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t){return k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},k(e,t)}function $(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}var q=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(s,e);var t,r,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=N(i);if(o){var r=N(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return $(this,e)});function s(){var e;return C(this,s),(e=a.apply(this,arguments)).renderTimeline=function(t){var r,i=t.getPrefixCls,o=e.props,a=o.prefixCls,s=o.pending,c=void 0===s?null:s,u=o.pendingDot,l=o.children,p=o.className,d=o.reverse,f=o.mode,y=q(o,["prefixCls","pending","pendingDot","children","className","reverse","mode"]),b=i("timeline",a),v="boolean"==typeof c?null:c,m=h()(b,(P(r={},"".concat(b,"-pending"),!!c),P(r,"".concat(b,"-reverse"),!!d),P(r,"".concat(b,"-").concat(f),!!f),r),p),g=c?n.createElement(E,{pending:!!c,dot:u||n.createElement(x.Z,{type:"loading"})},v):null,O=d?[g].concat(D(n.Children.toArray(l).reverse())):[].concat(D(n.Children.toArray(l)),[g]),_=function(e,t){return"alternate"===f?"right"===e.props.position?"".concat(b,"-item-right"):"left"===e.props.position?"".concat(b,"-item-left"):"".concat(b,t%2==0?"-item-left":"-item-right"):"left"===f?"".concat(b,"-item-left"):"right"===f||"right"===e.props.position?"".concat(b,"-item-right"):""},S=O.filter((function(e){return!!e})),j=n.Children.count(S),C="".concat(b,"-item-last"),Q=n.Children.map(S,(function(e,t){var r=t===j-2?C:"",i=t===j-1?C:"";return n.cloneElement(e,{className:h()([e.props.className,!d&&c?r:i,_(e,t)])})}));return n.createElement("ul",w({},y,{className:m}),Q)},e}return t=s,(r=[{key:"render",value:function(){return n.createElement(m.C,null,this.renderTimeline)}}])&&Q(t.prototype,r),s}(n.Component);I.Item=E,I.defaultProps={reverse:!1,mode:""};var R=I,z=r(63286),T=r(32513),A=r(35277),L=r(41253),M=r(76970),Z=r(14962),U=r(55702);function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var J=z.Z,Y=n.lazy((function(){return r.e(5220).then(r.bind(r,25220))})),B={0:"welcome Gizzy",50:"waiting for payment confirmation",9:"Pending",10:"Paided",11:"Booking canceled",4:"Job started",13:"Ongoing",14:"Completed"},K=U.Z.create()((function(e){var t=(0,i.Z)(),r=(t.history,t.match),s=G((0,n.useState)(!1),2),u=s[0],l=s[1],f=G((0,n.useState)(0),2),b=(f[0],f[1],G((0,n.useState)([]),2)),h=b[0],v=b[1],m=G((0,n.useState)({}),2),g=m[0],O=m[1];console.log("match.params.id",r.params.id);var _=function(e,t,r){void 0===r&&(r=!1);var i=(0,n.useContext)((0,a.KZ)()),s=(0,n.useReducer)((function(e){return e+1}),0),u=s[0],l=s[1],d=t?o.pi({},t,{query:e}):{query:e},f=(0,n.useRef)();f.current||(f.current=new p({options:d,context:i,forceUpdate:l}));var y=f.current;y.setOptions(d),y.context=i;var b,h,v,m=(b=function(){return r?y.executeLazy():y.execute()},h={options:d,context:i,tick:u},(v=(0,n.useRef)()).current&&(0,c.D)(h,v.current.key)||(v.current={key:h,value:b()}),v.current.value);return(0,n.useEffect)((function(){return y.afterExecute({lazy:r})}),[m]),m}(d.aY,{variables:{contract_id:r.params.id,location_code:"IN"}},!1),E=_.data,x=_.loading;return _.error,(0,n.useEffect)((function(){v(E.get_biding_milestone)}),[E]),n.createElement(n.Fragment,null,h&&h.length>0&&n.createElement(n.Fragment,null,n.createElement(T.Z,{spinning:x},n.createElement(J,{className:"my-5",level:3},"Project Milestone"),n.createElement(R,null,h&&h.map((function(e,t){return console.log("started"!==(null==e?void 0:e.title)),n.createElement(R.Item,{key:null==e?void 0:e.title,color:14===(null==e?void 0:e.booking_status)?"green":"gray",className:"pb-4"},n.createElement("div",{className:"normal_font_size bold"},"Milestone ",t,": ",null==e?void 0:e.title),n.createElement("div",{className:"d-flex justify-content-between align-items-center"},n.createElement("div",null,!y()(["started","Complete"],null==e?void 0:e.title)&&n.createElement("div",{className:"normal_font_size primary_color py-1"},null==e?void 0:e.budget),n.createElement("div",{className:"d-flex"},n.createElement("div",{className:"bold"},n.createElement(A.Z,{status:"success"})," ",null==e?void 0:e.created_at),n.createElement("div",{className:"text-danger px-3"},B[null==e?void 0:e.booking_status]))),n.createElement("div",{className:""},n.createElement(L.Z,{onClick:function(){O(e),l(!u)},color:"green",className:"cursor_point normal_font_size p-2"},"View Detail"))))}))))),n.createElement(M.Z,{visible:u,footer:null,onCancel:function(){l(!u)}},n.createElement(n.Suspense,{fallback:n.createElement(Z.Z,{active:!0})},n.createElement(Y,{data:g}))))}))},55128:function(e,t,r){r.d(t,{aY:function(){return c},y$:function(){return u}});var n,i,o,a=r(82992);function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var c=(0,a.ZP)(n||(n=s(["\n    query GETMILESTONEPAGINATION($_id:ID,$contract_id:ID,$biding_id:ID,$location_code:String){\n        get_biding_milestone(_id:$_id,contract_id:$contract_id,biding_id:$biding_id){\n                _id\n                budget(code:$location_code)\n                ref: milestone_ref\n                created_at\n                user_id\n                contract_id\n                timeline\n                timeline_type\n                payment_option(code:$location_code)\n                booking_status\n                description\n                title\n                pro_description\n                extra_fare\n                extra_fare_reason\n                total(code:$location_code)\n                get_milestone_all_images(root:true){\n                    small_image\n                }\n        }\n    }\n"]))),u=((0,a.ZP)(i||(i=s(["\n    query GETMILESTONEDETAIL($_id:ID,$contract_id:ID,$biding_id:ID){\n        get_biding_milestone_detail(_id:$_id,contract_id:$contract_id,biding_id:$biding_id){\n            _id\n            budget\n            ref: milestone_ref\n            created_at\n            user_id\n            contract_id\n            description\n            timeline\n            timeline_type\n        }\n    }\n"]))),(0,a.ZP)(o||(o=s(["\nmutation UPDATEMILESTONE($option:String  \n    $_id:ID\n    $user_id: String\n    $provider_id:ID\n    $biding_id:ID\n    $contract_id:ID\n    $file:[Upload]\n    $milestone_data:JSON){ \n    update_milestone(\n        option:$option  \n        _id:$_id\n        user_id: $user_id\n        provider_id:$provider_id\n        biding_id:$biding_id\n        contract_id:$contract_id\n        file:$file\n        milestone_data:$milestone_data\n  ) {\n    msg\n    status\n  }\n}"]))))}}]);