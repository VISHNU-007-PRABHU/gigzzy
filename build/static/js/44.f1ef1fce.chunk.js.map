{"version":3,"sources":["component/Admin/Roles/AdminRoles.js"],"names":["AdminRoles","props","handleTableChange","pagination","a","pager","current","setState","loading","client","query","GET_ADMIN_ROLES","variables","limit","pageSize","page","role","fetchPolicy","then","result","console","log","data","state","total","get_admin_roles","pageInfo","totalDocs","dataSource","fetch_user","visible","handleDelete","_id","mutate","mutation","DELETE_ADMIN_ROLES","error","Alert_msg","delete_admin_roles","status","onFilter","value","target","datas","$or","$regex","$options","SEARCH_ROLE","roles_search","search_user","simple","this","columns","title","width","render","text","record","name","className","style","wordBreak","key","dataIndex","RoleViewFunction","length","permission","onClick","history","push","type","theme","twoToneColor","onConfirm","size","placeholder","onKeyUp","event","id","rowClassName","onChange","React","Component","withRouter"],"mappings":"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","file":"static/js/44.f1ef1fce.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { GET_ADMIN_ROLES, DELETE_ADMIN_ROLES, SEARCH_ROLE } from '../../../graphql/Admin/roles';\r\nimport { client } from \"../../../apollo\";\r\nimport { Table, Button, Icon, Popconfirm } from 'antd';\r\nimport { Alert_msg } from '../../Comman/alert_msg';\r\nimport Search from \"antd/es/input/Search\";\r\nimport RoleView, { RoleViewFunction } from '../../Comman/roles_permission_view'\r\nclass AdminRoles extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            dataSource: [],\r\n            search_user: [],\r\n            loading: false,\r\n            pagination: {\r\n                pageSize: 10,\r\n                current: 1,\r\n                total: 0,\r\n                simple: true,\r\n            }\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        this.fetch_user();\r\n    }\r\n    handleTableChange = async pagination => {\r\n        const pager = { ...pagination };\r\n        pager.current = pagination.current;\r\n        this.setState({ loading: true });\r\n\r\n        await client.query({\r\n            query: GET_ADMIN_ROLES,\r\n            variables: { limit: pager.pageSize, page: pager.current, role: \"1\" },\r\n            fetchPolicy: 'no-cache',\r\n        }).then(result => {\r\n            console.log(result.data);\r\n            const pagination = { ...this.state.pagination };\r\n            pagination.total = result.data.get_admin_roles.pageInfo.totalDocs;\r\n            pagination.current = result.data.get_admin_roles.pageInfo.page;\r\n            console.log(pagination);\r\n            this.setState({ pagination, loading: false, dataSource: result.data.get_admin_roles.data });\r\n        });\r\n    };\r\n\r\n    fetch_user = async (visible) => {\r\n        this.setState({ loading: true });\r\n\r\n        await client.query({\r\n            query: GET_ADMIN_ROLES,\r\n            variables: { limit: this.state.pagination.pageSize, page: this.state.pagination.current, role: \"1\" },\r\n            fetchPolicy: 'no-cache',\r\n        }).then(result => {\r\n            const pagination = { ...this.state.pagination };\r\n            pagination.total = result.data.get_admin_roles.pageInfo.totalDocs;\r\n            this.setState({ loading: false, pagination, dataSource: result.data.get_admin_roles.data });\r\n        });\r\n    }\r\n\r\n    handleDelete = async (_id) => {\r\n        await client.mutate({\r\n            mutation: DELETE_ADMIN_ROLES,\r\n            variables: { _id: _id },\r\n        }).then((result, loading, error) => {\r\n            Alert_msg(result.data.delete_admin_roles);\r\n            if (result.data.delete_admin_roles.status === 'success') {\r\n                this.fetch_user();\r\n            }\r\n        });\r\n    }\r\n\r\n    onFilter = async (value) => {\r\n        console.log(value.target.value);\r\n        var datas = { $or: [{ 'name': { $regex: '.*' + value.target.value + '.*', $options: 'i' } }, { 'key': { $regex: '.*' + value.target.value + '.*', $options: 'i' } }] }\r\n        await client.query({\r\n            query: SEARCH_ROLE,\r\n            variables: { data: datas },\r\n            fetchPolicy: 'no-cache',\r\n        }).then(result => {\r\n            this.setState({ dataSource: result?.data?.roles_search });\r\n        });\r\n    }\r\n    render() {\r\n        const { dataSource } = this.state;\r\n\r\n        const columns = [\r\n            {\r\n                title: \"Roles Name\",\r\n                width: '20%',\r\n                render: (text, record) => {\r\n                    return <span title=\"Roles Name\">{record?.name}</span>;\r\n                }\r\n\r\n            },\r\n            {\r\n                title: () => {\r\n                    return <div>\r\n                        <div className=\"d-block\">\r\n                            <div>\r\n                                Key Roles\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                },\r\n                width: '20%',\r\n                render: (text, record) => {\r\n                    return <span title=\"Key Roles\" style={{ wordBreak: \"keep-all\" }}>{record?.key}</span>;\r\n                }\r\n\r\n            },\r\n            {\r\n                title: \"Action\",\r\n                dataIndex: 'operation',\r\n                className: RoleViewFunction('edit_roles') || RoleViewFunction('delete_roles') ? '' : 'd-none',\r\n                render: (text, record) =>\r\n                    this.state.dataSource.length >= 1 ? (\r\n                        <span title=\"....\" className=\"d-inline d-md-flex justify-content-around\">\r\n                            <RoleView permission=\"edit_roles\">\r\n                                <span className='cursor_point' onClick={() => { this.props.history.push(`/admin-roles/add/${record._id}`); }}><Icon type=\"edit\" theme=\"twoTone\" twoToneColor=\"#52c41a\" className='mx-3 f_25' /></span>\r\n                            </RoleView>\r\n                            <RoleView permission=\"delete_roles\">\r\n                                <Popconfirm title=\"Sure to delete the user ?\" onConfirm={() => this.handleDelete(record._id)}>\r\n                                    <Icon type=\"delete\" theme=\"twoTone\" twoToneColor=\"#52c41a\" className='f_25' />\r\n                                </Popconfirm>\r\n                            </RoleView>\r\n                        </span>\r\n                    ) : null,\r\n            },\r\n        ];\r\n\r\n\r\n        return (\r\n            <div>\r\n                <div className='mx-2 mx-sm-0 mb-3'>\r\n                    <Search size=\"large\" placeholder=\"search\" onKeyUp={(event) => { this.onFilter(event) }} loading={false} />\r\n                </div>\r\n                <div id=\"no-more-tables\">\r\n                    <Table\r\n                        rowClassName={() => 'editable-row'}\r\n                        className='table_shadow'\r\n                        dataSource={dataSource}\r\n                        columns={columns}\r\n                        size=\"middle\"\r\n                        pagination={this.state.pagination}\r\n                        onChange={this.handleTableChange}\r\n                        loading={this.state.loading}\r\n                    />\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(AdminRoles);"],"sourceRoot":""}