(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1947:function(e,t,a){"use strict";a.r(t);var n=a(3),i=a.n(n),r=a(22),s=a(5),o=a(14),c=a(13),l=a(15),m=a(16),u=a(1),p=a.n(u),d=a(74),h=a(1920),y=a(172),f=a(96),_=a(276),v=a(411),w=a(602),b=a(413),g=a(1918),E=a(173),k=a(23),P=a(335),j=a(1921),S=a(6),C=a(20),O=a(189),x=a(24),q=(v.a.Title,y.a.Option),D=_.a.Panel,A=function(e){Object(m.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={visible:!1,visibleAddPermission:!1,dataSource:[],pagination:{pageSize:10,current:1,total:0,simple:!0},items:["jack","lucy"],permission:[],name:"",input_new_type:!1},e.fetch_permission=function(){var t=Object(s.a)(i.a.mark(function t(a){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.next=3,S.a.query({query:O.g,variables:{limit:e.state.pagination.pageSize,page:e.state.pagination.current},fetchPolicy:"no-cache"}).then(function(t){var a=Object(r.a)({},e.state.pagination);a.total=t.data.get_admin_permission.pageInfo.totalDocs,e.setState({loading:!1,pagination:a,permission:t.data.get_admin_permission.data,dataSource:t.data.get_admin_permission.data})});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.showDrawer=function(){e.setState({visible:!0})},e.showModal=function(){e.setState({visibleAddPermission:!0})},e.onClose=function(){e.setState({visible:!1}),e.props.closePermission()},e.handleDelete=function(){var t=Object(s.a)(i.a.mark(function t(a){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a),t.next=3,S.a.mutate({mutation:O.c,variables:{_id:a}}).then(function(t,a,n){Object(C.a)(t.data.delete_admin_permission),"success"===t.data.delete_admin_permission.status&&e.fetch_permission()});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.add_new_permission=Object(s.a)(i.a.mark(function t(){var a,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=e.props,n=a.form,a.history,n.validateFields(function(){var t=Object(s.a)(i.a.mark(function t(a,n){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.a.mutate({mutation:O.a,variables:{type:n.input_new_type?n.add_new_type:n.type,name:n.name,key:n.key}}).then(function(){var t=Object(s.a)(i.a.mark(function t(a,n,r){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(C.a)(a.data.add_admin_permission),"success"!==a.data.add_admin_permission.status){t.next=5;break}return e.fetch_permission(),t.next=5,e.setState({visibleAddPermission:!1});case 5:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t)})),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.form.resetFields(),this.fetch_permission()}},{key:"componentWillReceiveProps",value:function(e){e.active!==this.state.active&&this.setState({visible:e.active})}},{key:"render",value:function(){var e=this,t=this.props.form;return p.a.createElement(p.a.Fragment,null,p.a.createElement(h.a,{title:p.a.createElement(p.a.Fragment,null,p.a.createElement("div",null,p.a.createElement(x.b,{permission:"add_permission"},p.a.createElement(f.a,{type:"primary",onClick:this.showModal},"Create a new permission")))),width:500,onClose:this.onClose,visible:this.state.visible,bodyStyle:{paddingBottom:80},footer:p.a.createElement("div",{style:{textAlign:"right"}},p.a.createElement(f.a,{onClick:this.onClose,style:{marginRight:8}},"Cancel"),p.a.createElement(f.a,{onClick:this.onClose,type:"primary"},"Submit"))},p.a.createElement("div",{className:"p-3"},p.a.createElement(_.a,{accordion:!0},this.state.dataSource.map(function(t,a){return p.a.createElement(D,{key:a,header:p.a.createElement("div",{className:"d-flex justify-content-between"},p.a.createElement("div",null,t._id),p.a.createElement(b.a,{count:t.count?t.count:0}))},t.permission.map(function(t){return p.a.createElement("div",{className:"d-flex jumbotron p-1 my-2 justify-content-between align-items-center"},p.a.createElement("div",null,p.a.createElement("div",{className:"bold"},t.name),p.a.createElement("div",null,t.key)),p.a.createElement(x.b,{permission:"delete_permission"},p.a.createElement("div",null,p.a.createElement(w.a,{title:"Sure to delete this permission ?",onConfirm:function(){return e.handleDelete(t._id)}},p.a.createElement(k.a,{type:"delete",theme:"twoTone",twoToneColor:"#52c41a",className:"f_25"})))))}))})))),p.a.createElement(P.a,{title:"Add new permission",visible:this.state.visibleAddPermission,onOk:this.add_new_permission,onCancel:function(){e.setState({visibleAddPermission:!1})}},p.a.createElement(j.a.Item,{label:"Input Permission Type"},t.getFieldDecorator("input_new_type",{initialValue:this.state.input_new_type,rules:[{required:!1,message:"Permission type is required"}]})(p.a.createElement(E.a,{onChange:function(){e.setState({input_new_type:!e.state.input_new_type})}},"Are you create new permission type"))),p.a.createElement(j.a.Item,{className:this.state.input_new_type?"":"d-none",label:"Permission Type"},t.getFieldDecorator("add_new_type",{rules:[{required:this.state.input_new_type,message:"Permission type is required"}]})(p.a.createElement(g.a,{placeholder:"Enter your new permission"}))),p.a.createElement(j.a.Item,{className:this.state.input_new_type?"d-none":"",label:"Permission type"},t.getFieldDecorator("type",{rules:[{required:!this.state.input_new_type,message:"Permission type is required"}]})(p.a.createElement(y.a,{style:{width:"100%"},placeholder:"Permission type"},this.state.permission.map(function(e){return p.a.createElement(q,{key:e._id},e._id)})))),p.a.createElement(j.a.Item,{label:"Permission Name"},t.getFieldDecorator("name",{initialValue:this.state.name,rules:[{required:!0,message:"Permission name is required"}]})(p.a.createElement(g.a,{placeholder:"Permission Name"}))),p.a.createElement(j.a.Item,{label:"Permission Key"},t.getFieldDecorator("key",{initialValue:this.state.key,rules:[{required:!0,message:"Permission key is required"}]})(p.a.createElement(g.a,{placeholder:"Permission Key"})))))}}]),a}(p.a.Component);t.default=j.a.create()(Object(d.withRouter)(A))}}]);
//# sourceMappingURL=15.1fa86919.chunk.js.map