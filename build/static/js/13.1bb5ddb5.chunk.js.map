{"version":3,"sources":["component/Admin/Roles/AdminPermission.js"],"names":["Option","Typography","Title","Select","Panel","Collapse","AdminPermission","state","visible","visibleAddPermission","dataSource","pagination","pageSize","current","total","simple","items","permission","name","input_new_type","fetch_permission","_callee","_home_waioz_gigzzy_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","wrap","_context","prev","next","_this","setState","loading","client","query","GET_ADMIN_PERMISSION","variables","limit","page","fetchPolicy","then","result","Object","_home_waioz_gigzzy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__","data","get_admin_permission","pageInfo","totalDocs","stop","showDrawer","showModal","onClose","props","closePermission","handleDelete","_callee2","_id","_context2","console","log","mutate","mutation","DELETE_ADMIN_PERMISSION","error","Alert_msg","delete_admin_permission","status","add_new_permission","_callee5","_this$props","form","_context5","history","validateFields","_ref4","_home_waioz_gigzzy_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__","mark","_callee4","err","values","_context4","ADD_ADMIN_PERMISSION","type","key","_ref5","_callee3","_context3","add_admin_permission","_x5","_x6","_x7","apply","this","arguments","_x3","_x4","resetFields","nextProps","active","_this2","react__WEBPACK_IMPORTED_MODULE_7___default","createElement","Fragment","antd_es_drawer__WEBPACK_IMPORTED_MODULE_9__","title","antd_es_button__WEBPACK_IMPORTED_MODULE_11__","onClick","width","bodyStyle","paddingBottom","footer","style","textAlign","marginRight","className","antd_es_collapse__WEBPACK_IMPORTED_MODULE_12__","accordion","map","main_permission","i","header","antd_es_badge__WEBPACK_IMPORTED_MODULE_15__","count","sub_permission","antd_es_popconfirm__WEBPACK_IMPORTED_MODULE_14__","onConfirm","antd_es_icon__WEBPACK_IMPORTED_MODULE_18__","theme","twoToneColor","antd_es_modal__WEBPACK_IMPORTED_MODULE_19__","onOk","onCancel","antd_es_form__WEBPACK_IMPORTED_MODULE_20__","Item","label","getFieldDecorator","initialValue","rules","required","message","antd_es_checkbox__WEBPACK_IMPORTED_MODULE_17__","onChange","antd_es_input__WEBPACK_IMPORTED_MODULE_16__","placeholder","antd_es_select__WEBPACK_IMPORTED_MODULE_10__","React","Component","Form","create","withRouter"],"mappings":"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","file":"static/js/13.1bb5ddb5.chunk.js","sourcesContent":["import React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport Drawer from 'antd/es/drawer';\nimport Select from 'antd/es/select';\nimport Button from 'antd/es/button';\nimport Collapse from 'antd/es/collapse';\nimport Typography from 'antd/es/typography';\nimport Popconfirm from 'antd/es/popconfirm';\nimport Badge from 'antd/es/badge';\nimport Input from 'antd/es/input';\nimport Row from 'antd/es/row';\nimport Checkbox from 'antd/es/checkbox';\nimport Icon from 'antd/es/icon';\nimport Modal from 'antd/es/modal';\nimport Form from 'antd/es/form';\nimport { client } from \"../../../apollo\";\nimport { Alert_msg } from '../../Comman/alert_msg';\nimport { DELETE_ADMIN_PERMISSION, GET_FETCH_ADMIN_PERMISSION, GET_ADMIN_PERMISSION, ADD_ADMIN_PERMISSION } from '../../../graphql/Admin/roles';\nconst { Title } = Typography;\nconst { Option } = Select;\nconst { Panel } = Collapse;\nlet index = 0;\nclass AdminPermission extends React.Component {\n    state = {\n        visible: false,\n        visibleAddPermission: false,\n        dataSource: [],\n        pagination: {\n            pageSize: 10,\n            current: 1,\n            total: 0,\n            simple: true,\n        },\n        items: ['jack', 'lucy'],\n        permission: [],\n        name: '',\n        input_new_type: false\n    };\n\n    componentDidMount() {\n        const { form } = this.props;\n        form.resetFields();\n        this.fetch_permission();\n    }\n\n    fetch_permission = async (visible) => {\n        this.setState({ loading: true });\n\n        await client.query({\n            query: GET_ADMIN_PERMISSION,\n            variables: { limit: this.state.pagination.pageSize, page: this.state.pagination.current },\n            fetchPolicy: 'no-cache',\n        }).then(result => {\n            const pagination = { ...this.state.pagination };\n            pagination.total = result.data.get_admin_permission.pageInfo.totalDocs;\n            this.setState({\n                loading: false,\n                pagination,\n                permission: result.data.get_admin_permission.data,\n                dataSource: result.data.get_admin_permission.data\n            });\n        });\n    }\n\n    showDrawer = () => {\n        this.setState({\n            visible: true,\n        });\n    };\n\n\n    showModal = () => {\n        this.setState({\n            visibleAddPermission: true,\n        });\n    };\n    onClose = () => {\n        this.setState({\n            visible: false,\n        });\n        this.props.closePermission()\n    };\n\n    componentWillReceiveProps(nextProps) {\n        if (nextProps.active !== this.state.active) {\n            this.setState({ visible: nextProps.active });\n        }\n    }\n    handleDelete = async (_id) => {\n        console.log(_id);\n        await client.mutate({\n            mutation: DELETE_ADMIN_PERMISSION,\n            variables: { _id: _id },\n        }).then((result, loading, error) => {\n            Alert_msg(result.data.delete_admin_permission);\n            if (result.data.delete_admin_permission.status === 'success') {\n                this.fetch_permission();\n            }\n        });\n    }\n\n    add_new_permission = async () => {\n        const { form, history } = this.props;\n        form.validateFields(async (err, values) => {\n            await client.mutate({\n                mutation: ADD_ADMIN_PERMISSION,\n                variables: { type: values['input_new_type'] ? values['add_new_type'] : values['type'], name: values['name'], key: values['key'] },\n            }).then(async (result, loading, error) => {\n                Alert_msg(result.data.add_admin_permission);\n                if (result.data.add_admin_permission.status === 'success') {\n                    this.fetch_permission();\n                    await this.setState({ visibleAddPermission: false })\n                }\n            });\n        })\n    };\n\n\n    render() {\n        const { form } = this.props;\n        return (\n            <>\n                <Drawer\n                    title={<><div>\n                        <Button type=\"primary\" onClick={this.showModal}>\n                            Create a new permission\n                        </Button>\n                    </div></>}\n                    width={500}\n                    onClose={this.onClose}\n                    visible={this.state.visible}\n                    bodyStyle={{ paddingBottom: 80 }}\n                    footer={\n                        <div\n                            style={{\n                                textAlign: 'right',\n                            }}\n                        >\n                            <Button onClick={this.onClose} style={{ marginRight: 8 }}>\n                                Cancel\n                            </Button>\n                            <Button onClick={this.onClose} type=\"primary\">\n                                Submit\n                            </Button>\n                        </div>\n                    }\n                >\n                    <div className=\"p-3\">\n                        <Collapse accordion >\n                            {this.state.dataSource.map((main_permission, i) => (\n                                <Panel key={i} header={<div className=\"d-flex justify-content-between\">\n                                    <div>{main_permission['_id']}</div>\n                                    <Badge count={main_permission['count'] ? main_permission['count'] : 0} />\n                                </div>} >\n                                    {main_permission['permission'].map(sub_permission => {\n                                        return (<div className=\"d-flex jumbotron p-1 my-2 justify-content-between align-items-center\">\n                                            <div>\n                                                <div className=\"bold\">{sub_permission['name']}</div>\n                                                <div>{sub_permission['key']}</div>\n                                            </div>\n                                            <div>\n                                                <Popconfirm title=\"Sure to delete this permission ?\" onConfirm={() => this.handleDelete(sub_permission['_id'])}>\n                                                    <Icon type=\"delete\" theme=\"twoTone\" twoToneColor=\"#52c41a\" className='f_25' />\n                                                </Popconfirm>\n                                            </div>\n                                        </div>)\n                                    })}\n                                </Panel>\n                            ))}\n                        </Collapse>\n                    </div>\n                </Drawer>\n                <Modal\n                    title=\"Add new permission\"\n                    visible={this.state.visibleAddPermission}\n                    onOk={this.add_new_permission}\n                    onCancel={() => { this.setState({ visibleAddPermission: false }) }}\n                >\n\n                    <Form.Item label=\"Input Permission Type\">\n                        {form.getFieldDecorator(\"input_new_type\", {\n                            initialValue: this.state.input_new_type,\n                            rules: [{ required: false, message: 'Permission type is required' }]\n                        })(<Checkbox onChange={() => { this.setState({ input_new_type: !this.state.input_new_type }) }}>Are you create new permission type</Checkbox>)}\n                    </Form.Item>\n                    <Form.Item className={this.state.input_new_type ? '' : 'd-none'} label=\"Permission Type\">\n                        {form.getFieldDecorator(\"add_new_type\", {\n                            rules: [{ required: this.state.input_new_type, message: 'Permission type is required' }]\n                        })(<Input placeholder=\"Enter your new permission\" />)}\n                    </Form.Item>\n                    <Form.Item className={this.state.input_new_type ? 'd-none' : ''} label=\"Permission type\">\n                        {form.getFieldDecorator(\"type\", {\n                            // initialValue: this.state.permission,\n                            rules: [{ required: !this.state.input_new_type, message: 'Permission type is required' }]\n                        })(<Select style={{ width: '100%' }} placeholder=\"Permission type\">\n                            {this.state.permission.map(data =>\n                                <Option key={data._id}>{data._id}</Option>\n                            )}\n                        </Select>)}\n                    </Form.Item>\n                    <Form.Item label=\"Permission Name\">\n                        {form.getFieldDecorator(\"name\", {\n                            initialValue: this.state.name,\n                            rules: [{ required: true, message: 'Permission name is required' }]\n                        })(<Input placeholder=\"Permission Name\" />)}\n                    </Form.Item>\n                    <Form.Item label=\"Permission Key\">\n                        {form.getFieldDecorator(\"key\", {\n                            initialValue: this.state.key,\n                            rules: [{ required: true, message: 'Permission key is required' }]\n                        })(<Input placeholder=\"Permission Key\" />)}\n                    </Form.Item>\n                </Modal>\n            </>\n        );\n    }\n}\nexport default Form.create()(withRouter(AdminPermission));"],"sourceRoot":""}