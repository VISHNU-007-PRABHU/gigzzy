(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{2047:function(e,a,t){"use strict";t.r(a);var l,n=t(3),o=t.n(n),c=t(5),i=t(12),r=t(13),s=t(238),m=t(15),u=t(14),d=t(18),b=t(1),p=t.n(b),_=t(164),g=t(23),E=t(968),v=(t(43),t(47),t(6)),k=t(63),y=t(19),f=t.n(y),h=t(70),N=t(209),x=t.n(N),w=t(605),O=t.n(w),S=p.a.lazy(function(){return t.e(3).then(t.bind(null,1939))}),j={0:"welcome Gizzy",50:"waiting for payment confirmation",10:"Base price paid",11:"Booking canceled",4:"Job started",13:"Ongoing",14:"Completed"},z=O()(),B=f()(l||(l=Object(d.a)(['\nsubscription SENDACCEPTMSG($_id:ID,$booking_id:ID){\n    send_accept_msg (_id:$_id,booking_id:$booking_id){\n      _id\n      status\n      booking_status\n      payment_type\n      mpeas_payment_callback\n      base_price(code:"symbol")\n      extra_price(code:"symbol")\n      ctob_shotcode\n      ctob_billRef\n    }\n}']))),D=function(e){Object(m.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(e=a.call.apply(a,[this].concat(n))).state={currency_symbol:"Ksh",collapsed:!1,booking:[],booking_user:[],booking_provider:[],booking_category:[],booking_status:0,payment_type:"",mpeas_payment_callback:!1,base_price:"0.00",extra_price:"0.00",ctob_shotcode:"",ctob_billRef:""},e.fetch_booking=function(a){v.a.query({query:h.f,variables:{_id:a},fetchPolicy:"no-cache"}).then(function(a){var t,l,n,o,c,i,r,s,m,u,d,b,p;console.log(a),e.current_booking_status(null===(t=e.props.match)||void 0===t?void 0:null===(l=t.params)||void 0===l?void 0:l.id),e.setState({booking:a.data.booking,booking_category:null===(n=a.data.booking[0])||void 0===n?void 0:n.booking_category,booking_user:null===(o=a.data.booking[0])||void 0===o?void 0:o.booking_user,booking_provider:null===(c=a.data.booking[0])||void 0===c?void 0:c.booking_provider,message:null===(i=a.data.booking[0])||void 0===i?void 0:i.get_booking_message,booking_status:null===(r=a.data.booking[0])||void 0===r?void 0:r.booking_status,payment_type:(null===(s=a.data.booking[0])||void 0===s?void 0:s.payment_type)||"",base_price:(null===(m=a.data.booking[0])||void 0===m?void 0:m.base_price)||"",extra_price:(null===(u=a.data.booking[0])||void 0===u?void 0:u.extra_price)||"",ctob_shotcode:(null===(d=a.data.booking[0])||void 0===d?void 0:d.ctob_shotcode)||"",ctob_billRef:(null===(b=a.data.booking[0])||void 0===b?void 0:b.ctob_billRef)||"",mpeas_payment_callback:null===(p=a.data.booking[0])||void 0===p?void 0:p.mpeas_payment_callback})})},e.current_booking_status=function(){var a=Object(c.a)(o.a.mark(function a(t){var l;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=Object(s.a)(e),a.next=3,v.a.subscribe({query:B,variables:{_id:JSON.parse(localStorage.getItem("user"))._id,booking_id:t}}).subscribe({next:function(e,a,t){var n;(a&&console.log("load"),e)&&(console.log(e.data.send_accept_msg),l.setState({booking_status:e.data.send_accept_msg.booking_status,payment_type:(null===(n=e.data.send_accept_msg)||void 0===n?void 0:n.payment_type)||""}))}});case 3:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),e}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.match.params.id&&this.fetch_booking(this.props.match.params.id)}},{key:"render",value:function(){var e,a,t=this.state,l=t.ctob_billRef,n=t.ctob_shotcode,o=t.mpeas_payment_callback,c=t.base_price,i=t.extra_price,r=t.booking,s=t.booking_category,m=t.booking_provider,u=t.booking_user,d=t.payment_type,v=t.booking_status;return console.log("Invoice -> render -> booking_status",v),console.log("Invoice -> render -> mpeas_payment_callback",o),console.log("Invoice -> render -> payment_option",d),p.a.createElement("div",{className:" col-xs-12 col-md-12 col-sm-12 invoice_body_color  "},p.a.createElement("div",{className:"col-xs-12 col-md-12 col-sm-12 col-lg-6 main_content mx-lg-auto"},p.a.createElement("div",{className:"invoice_header mt-1"},p.a.createElement("div",{className:z.isMobile()?"d-none":""},p.a.createElement("a",{href:"/bookings"},p.a.createElement(_.a,{placement:"left",title:"Back to Booking"},p.a.createElement(g.a,{className:"ml-2 cursor_point",type:"arrow-left",style:{fontSize:"26px"}})))),p.a.createElement("div",null,p.a.createElement("img",{src:x.a,alt:"gigzzy",className:"w-50x object_fit cursor_point"})),p.a.createElement("div",{className:"invoice_info"},p.a.createElement("div",null,"INVOICE NO ",p.a.createElement("b",null,r[0]?r[0].booking_ref:"")),p.a.createElement("div",null," ",p.a.createElement("small",null,r[0]?r[0].booking_date:"")),p.a.createElement("div",{className:"py-2"},p.a.createElement(E.a,{color:"green"},j[this.state.booking_status])))),p.a.createElement("div",{className:50!=v&&1!=o||"c2b"!=d?"d-none":"jumbotron p-1 mb-3 mx-3"},p.a.createElement(b.Suspense,{fallback:p.a.createElement("div",{class:"spinner-border text-success",role:"status"},p.a.createElement("span",{class:"sr-only"},"Loading..."))},p.a.createElement(S,{BusinessNumber:n,AmountNumber:l,Amount:o?i:c}))),p.a.createElement("div",{className:"user_batch mx-3"},p.a.createElement("p",null,p.a.createElement("b",null,u[0]?null===(e=u[0])||void 0===e?void 0:e.name:"")),p.a.createElement("p",null,"Thanks for using gigzzy.")),p.a.createElement("div",{className:"total_fare"},p.a.createElement("h5",null,"TOTAL COST"),p.a.createElement("h1",null,p.a.createElement("small",null),r[0]?r[0].total:"")),p.a.createElement("div",{className:"fare_estimation col-xs-12 col-md-12 col-sm-12 nopad d-print-block d-md-flex"},p.a.createElement("div",{className:"fare_breakup mr-sm-3"},p.a.createElement("p",{className:"title"},"Fare Breakup"),p.a.createElement("ul",null,p.a.createElement("li",null,p.a.createElement("label",null,"Base Price"),p.a.createElement("span",null,r[0]?r[0].base_price:"")),p.a.createElement("li",null,p.a.createElement("label",null,"Extra Price "),p.a.createElement("span",null,r[0]?r[0].extra_price:"")))),p.a.createElement("div",{className:"tax_breakup "},p.a.createElement("p",{className:"title"},"Service Breakup"),p.a.createElement("ul",null,p.a.createElement("li",null,p.a.createElement("label",{className:"d-flex align-items-center"},"Service Fee",p.a.createElement(_.a,{placement:"right",title:"".concat(null===(a=r[0])||void 0===a?void 0:a.service_fee," %")},p.a.createElement(g.a,{className:"ml-2 cursor_point",type:"info-circle"})),p.a.createElement("span",{className:"ml-auto"},r[0]?r[0].admin_fee:"")))))),p.a.createElement("div",{className:"booking_details col-xs-12 col-md-12 col-sm-12"},p.a.createElement("p",{className:"title"},"Booking Details"),p.a.createElement("ul",null,p.a.createElement("li",null,p.a.createElement("label",null,"Service Type"),p.a.createElement("span",null,s[0]?1===s[0].category_type?s[0].category_name:s[0].subCategory_name:"")),p.a.createElement("li",null,p.a.createElement("label",null,"Booking Date"),p.a.createElement("span",null,r[0]?r[0].booking_date:"")),p.a.createElement("li",null,p.a.createElement("label",null,"Scheduled Date"),p.a.createElement("span",null,r[0]?r[0].booking_date:"")))),p.a.createElement("div",{className:"member_section col-xs-12 col-md-12 col-sm-12 nopad d-print-block d-md-flex"},p.a.createElement("div",{className:"user_details mr-sm-3"},p.a.createElement("p",{className:"title"},"User Details"),p.a.createElement("ul",null,p.a.createElement("li",null,p.a.createElement("label",null,"Name"),p.a.createElement("span",null,u[0]?u[0].name:"")),p.a.createElement("li",null,p.a.createElement("label",null,"Email"),p.a.createElement("span",null,u[0]?u[0].email:"")),p.a.createElement("li",null,p.a.createElement("label",null,"Phone"),p.a.createElement("span",null,u[0]?u[0].phone_number:"")))),p.a.createElement("div",{className:"provider_details"},p.a.createElement("p",{className:"title"},"Provider Details"),p.a.createElement("ul",null,p.a.createElement("li",null,p.a.createElement("label",null,"Name"),p.a.createElement("span",null,m[0]?m[0].name:"")),p.a.createElement("li",null,p.a.createElement("label",null,"Email"),p.a.createElement("span",null,m[0]?m[0].email:"")),p.a.createElement("li",null,p.a.createElement("label",null,"Phone"),p.a.createElement("span",null,m[0]?m[0].phone_number:""))))),p.a.createElement("div",{className:"invoice_footer col-xs-12 m-3"},p.a.createElement("hr",null),p.a.createElement("p",null," Thanks,"),"gigzzy Team")))}}]),t}(p.a.Component);a.default=Object(k.withRouter)(D)}}]);
//# sourceMappingURL=39.5d687d72.chunk.js.map